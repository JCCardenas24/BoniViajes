const nCompleto = document.getElementById('nombre');
const correo = document.getElementById('mail');
const telefono = document.getElementById('phone');
const trip = document.getElementById('viaje');
const dRrange = document.getElementById('date_range');
const adultNumber = document.getElementById('input_adults_number');
const kidsNumber = document.getElementById('input_kids_number');
const inpts = document.querySelectorAll('.validate');
const btnSendData = document.getElementById('enviarCorreo');
const checkTC = document.getElementById('checkTerminos');
const inptLada = document.getElementById('lada');

$(function() {
    _url = "https://gist.githubusercontent.com/Goles/3196253/raw/9ca4e7e62ea5ad935bb3580dc0a07d9df033b451/CountryCodes.json";
    $.get(_url, function(data) {
      $.each(data, function(index, item) {
        $('#lada, #ladaRes').append('<option value="' + item.code + ' ' + item.dial_code + '">' + item.code + ' ' + item.dial_code + '</option>');
      })
    }, 'json');
})

inptLada.addEventListener('change', function() {
    if(this.value != '') {
        telefono.removeAttribute('disabled');
    } else {
        clearStyles(telefono);
        telefono.setAttribute('disabled', true);
    }
});

checkTC.addEventListener('change', function() {
    if(this.checked) {
        let inptsValid = document.querySelectorAll('.is-valid').length;
        if(inptsValid === 7) {
            btnSendData.removeAttribute('disabled');
            btnSendData.removeAttribute('disabled');
        } else {
            btnSendData.setAttribute('disabled', true);
            btnSendData.setAttribute('disabled', true);
        }
    } else {
        btnSendData.setAttribute('disabled', true);
        btnSendData.setAttribute('disabled', true);
    }
})

nCompleto.addEventListener('focusout', function() {
    let reg = /^[a-zA-Z\u00C0-\u00FF\s]*$/;
    checkTC.checked = false;
    btnSendData.setAttribute('disabled', true);
    btnSendData.setAttribute('disabled', true);
    clearStyles(nCompleto);
    if(nCompleto.value != '' && reg.test(nCompleto.value)) {
        nCompleto.classList.add('is-valid');
        return true;
    } else {
        nCompleto.classList.add('is-invalid');
        return false;
    }
});

correo.addEventListener('focusout', function() {
    let vMail = validateMail(this, this.value);
    checkTC.checked = false;
    btnSendData.setAttribute('disabled', true);
    btnSendData.setAttribute('disabled', true);
});

phone.addEventListener('focusout', function() {
    let vPhone = validateNumber(this, this.value);
    checkTC.checked = false;
    btnSendData.setAttribute('disabled', true);
    btnSendData.setAttribute('disabled', true);
});

trip.addEventListener('focusout', function() {
    let reg = /^[a-zA-Z\u00C0-\u00FF\s]*$/;
    checkTC.checked = false;
    btnSendData.setAttribute('disabled', true);
    btnSendData.setAttribute('disabled', true);
    clearStyles(trip);
    if(trip.value != '' && reg.test(trip.value)) {
        trip.classList.add('is-valid');
        return true;
    } else {
        trip.classList.add('is-invalid');
        return false;
    }
});

dRrange.addEventListener('focusout', function() {
    checkTC.checked = false;
    btnSendData.setAttribute('disabled', true);
    btnSendData.setAttribute('disabled', true);
    clearStyles(dRrange);
    if(dRrange.value != '') {
       dRrange.classList.add('is-valid');
        return true;
    } else {
        dRrange.classList.add('is-invalid');
        return false;
    }
});

adultNumber.addEventListener('focusout', (e) => {
    checkTC.checked = false;
    btnSendData.setAttribute('disabled', true);
    btnSendData.setAttribute('disabled', true);
    clearStyles(adultNumber);
    if(e.target.value != '0') {
        adultNumber.classList.add('is-valid');
         return true;
     } else {
        adultNumber.classList.add('is-invalid');
         return false;
     }
})

kidsNumber.addEventListener('focusout', (e) => {
    checkTC.checked = false;
    btnSendData.setAttribute('disabled', true);
    btnSendData.setAttribute('disabled', true);
    clearStyles(kidsNumber);
    if(e.target.value != '0') {
        kidsNumber.classList.add('is-valid');
         return true;
     } else {
        kidsNumber.classList.add('is-invalid');
         return false;
     }
})

/**
 * @author Juan Carlos Cárdenas
 * @param {Object} objInp - La etiqueta que se obtiene
 * @param {String} strInp - El valor de la etiqueta
 * @returns {Boolean} - True si se cumple que no es vacio y sólo contiene letras
 */
function validateString(objInp, strInp) {
    let reg = /^[a-zA-Z\u00C0-\u00FF\s]*$/;
    clearStyles(objInp)
    if(strInp != '' && reg.test(strInp)) {
        objInp.classList.add('is-valid');
        return true;
    } else {
        objInp.classList.add('is-invalid');
        return false;
    }
}

/**
 * @author Juan Carlos Cárdenas
 * @param {Object} objInp - La etiqueta que se obtiene
 * @param {String} numInp - El valor de la etiqueta
 * @returns {Boolean} - True si se cumple que no es vacio y sólo contiene números
 */

function validateNumber(objInp, numInp) {
    let reg = /[0-9]{10}/;
    clearStyles(objInp);
    if(numInp != '' && reg.test(numInp)) {
        objInp.classList.add('is-valid');
        return true;
    } else {
        objInp.classList.add('is-invalid');
        console.log('vacio');
        return false;
    }
}

/**
 * @author Juan Carlos Cárdenas
 * @param {Object} objInp - La etiqueta que se obtiene
 * @param {String} strInp - El valor de la etiqueta
 * @returns {Boolean} - True si se cumple que no es vacio y tiene estructura correcta de mail
 */

function validateMail(objInp, strInp) {
    let reg = /^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;
    clearStyles(objInp);
    if(strInp != '' && reg.test(strInp)) {
        objInp.classList.add('is-valid');
        return true;
    } else {
        objInp.classList.add('is-invalid');
        return false;
    }
}

function clearStyles(objElem) {
    objElem.classList.remove('is-valid');
    objElem.classList.remove('is-invalid');
}
